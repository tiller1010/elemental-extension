{"version":3,"sources":["webpack:///webpack/bootstrap cdeeb874511b1d8630ad","webpack:///./client/src/js/tinymce/TinyMCE_sslink-article.jsx","webpack:///external \"Injector\"","webpack:///external \"InsertLinkModal\"","webpack:///external \"React\"","webpack:///external \"ReactDom\"","webpack:///external \"TinyMCEActionRegistrar\"","webpack:///external \"i18n\"","webpack:///external \"jQuery\""],"names":["TinyMCEActionRegistrar","addAction","text","i18n","_t","onclick","editor","execCommand","priority","editorIdentifier","plugin","init","addCommand","field","window","jQuery","id","entwine","openLinkArticleDialog","modalId","sectionConfigKey","formName","InsertArticleLinkModal","$","dialog","length","append","addClass","setElement","open","renderModal","isOpen","handleHide","close","handleInsert","attrs","getOriginalAttributes","selection","tinymce","activeEditor","selectionContent","getContent","tagName","getNode","requireLinkText","trim","ReactDOM","render","buildAttributes","data","href","Link","target","TargetBlank","title","Description","PluginManager","add"],"mappings":"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","file":"js/TinyMCE_sslink-article.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./client/src/js/tinymce/TinyMCE_sslink-article.jsx\");\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap cdeeb874511b1d8630ad","/* global tinymce, editorIdentifier, window */\r\nimport i18n from 'i18n';\r\nimport TinyMCEActionRegistrar from 'lib/TinyMCEActionRegistrar';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport jQuery from 'jquery';\r\nimport { createInsertLinkModal } from 'containers/InsertLinkModal/InsertLinkModal';\r\nimport { loadComponent } from 'lib/Injector';\r\n\r\n// Link to article url\r\nTinyMCEActionRegistrar.addAction('sslink', {\r\n  text: i18n._t('Admin.LINKLABEL_ARTICLE', 'Link to Article'),\r\n  // eslint-disable-next-line no-console\r\n  onclick: (editor) => editor.execCommand('sslinkarticle'),\r\n  priority: 52,\r\n// }).addCommandWithUrlTest(\"sslinkarticle\", /^\\[article_link.+]$/);\r\n}, editorIdentifier);\r\n\r\nconst plugin = {\r\n  init(editor) {\r\n    editor.addCommand('sslinkarticle', () => {\r\n      const field = window.jQuery(`#${editor.id}`).entwine('ss');\r\n\r\n      field.openLinkArticleDialog();\r\n    });\r\n  },\r\n};\r\n\r\nconst modalId = 'insert-link__dialog-wrapper--article';\r\nconst sectionConfigKey = 'SilverStripe\\\\Admin\\\\LeftAndMain';\r\nconst formName = 'EditorArticleLink';\r\nconst InsertArticleLinkModal = loadComponent(createInsertLinkModal(sectionConfigKey, formName));\r\n\r\njQuery.entwine('ss', ($) => {\r\n  $('textarea.htmleditor').entwine({\r\n    openLinkArticleDialog() {\r\n      let dialog = $(`#${modalId}`);\r\n\r\n      if (!dialog.length) {\r\n        dialog = $(`<div id=\"${modalId}\" />`);\r\n        $('body').append(dialog);\r\n      }\r\n      dialog.addClass('insert-link__dialog-wrapper');\r\n\r\n      dialog.setElement(this);\r\n      dialog.open();\r\n    },\r\n  });\r\n\r\n  /**\r\n   * Assumes that $('.insert-link__dialog-wrapper').entwine({}); is defined for shared functions\r\n   */\r\n  $(`#${modalId}`).entwine({\r\n    renderModal(isOpen) {\r\n      const handleHide = () => this.close();\r\n      const handleInsert = (...args) => this.handleInsert(...args);\r\n      const attrs = this.getOriginalAttributes();\r\n      const selection = tinymce.activeEditor.selection;\r\n      const selectionContent = selection.getContent() || '';\r\n      const tagName = selection.getNode().tagName;\r\n      const requireLinkText = tagName !== 'A' && selectionContent.trim() === '';\r\n\r\n      // create/update the react component\r\n      ReactDOM.render(\r\n        <InsertArticleLinkModal\r\n          isOpen={isOpen}\r\n          onInsert={handleInsert}\r\n          onClosed={handleHide}\r\n          title={i18n._t('Admin.LINK_ARTICLE', 'Insert article link')}\r\n          bodyClassName=\"modal__dialog\"\r\n          className=\"insert-link__dialog-wrapper--article\"\r\n          fileAttributes={attrs}\r\n          identifier=\"Admin.InsertArticleLinkModal\"\r\n          requireLinkText={requireLinkText}\r\n        />,\r\n        this[0]\r\n      );\r\n    },\r\n\r\n    buildAttributes(data) {\r\n      // const attributes = this._super(data);\r\n\r\n      // let href = attributes.href;\r\n      // // Prefix the URL with \"http://\" if no prefix is found\r\n      // if (!href.match(/:\\/\\//)) {\r\n      //   href = `${window.location.protocol}//${href}`;\r\n      // }\r\n      // // if it's just the hash, then remove the prefix\r\n      // href = href.replace(/.*:\\/\\/(#.*)$/, '$1');\r\n\r\n      // // if it is just the prefix, then leave it blank\r\n      // if (href.match(/:\\/\\/$/)) {\r\n      //   href = '';\r\n      // }\r\n      // attributes.href = href;\r\n\r\n      // return attributes;\r\n      return {\r\n        href: data.Link,\r\n        target: data.TargetBlank ? \"_blank\" : \"\",\r\n        title: data.Description\r\n      }\r\n\r\n    },\r\n  });\r\n});\r\n\r\n// Adds the plugin class to the list of available TinyMCE plugins\r\ntinymce.PluginManager.add('sslinkarticle', (editor) => plugin.init(editor));\r\n\r\nexport default plugin;\n\n\n// WEBPACK FOOTER //\n// ./client/src/js/tinymce/TinyMCE_sslink-article.jsx","module.exports = Injector;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Injector\"\n// module id = 0\n// module chunks = 0","module.exports = InsertLinkModal;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"InsertLinkModal\"\n// module id = 1\n// module chunks = 0","module.exports = React;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"React\"\n// module id = 2\n// module chunks = 0","module.exports = ReactDom;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ReactDom\"\n// module id = 3\n// module chunks = 0","module.exports = TinyMCEActionRegistrar;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"TinyMCEActionRegistrar\"\n// module id = 4\n// module chunks = 0","module.exports = i18n;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"i18n\"\n// module id = 5\n// module chunks = 0","module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 6\n// module chunks = 0"],"sourceRoot":""}